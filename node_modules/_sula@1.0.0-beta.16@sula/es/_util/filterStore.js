import get from 'lodash/get';
import isObject from 'lodash/isObject';

/**
 * store {a: { b: 1}, m: undefined }  filterList [['a', 'b'], ['m'], ['n']] =>
 * [{name: ['a', 'b'], value: 1}, {name: ['m'], value: undefined}]
 */
export default function transStore(store, filterList) {
  var newStore = [];
  filterList.forEach(function (name) {
    if (!name.length) return;

    if (name.length === 1) {
      if (store.hasOwnProperty(name[0])) {
        newStore.push({
          name: name,
          value: get(store, name)
        });
      }
    } else {
      var subNamePath = name.slice(0, name.length - 1);
      var subValue = get(store, subNamePath);

      if (subValue && isObject(subValue) && subValue.hasOwnProperty(name[name.length - 1])) {
        newStore.push({
          name: name,
          value: get(store, name)
        });
      }
    }
  });
  return newStore;
}