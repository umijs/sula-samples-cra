var compile = require('tplstr/compile');

var resolveToArray = require('tplstr/resolve-to-array');

export default function (stringTemplate, params) {
  if (typeof stringTemplate !== 'string' || stringTemplate === '') return stringTemplate;
  var compiled = compile(stringTemplate);
  var resolvedArray = resolveToArray(compiled, params);
  /**
   * ['', 123, ''] => 123
   * 存在解析变量
   */

  var resolvedArrayLength = resolvedArray.length;

  if (resolvedArrayLength === 3 && resolvedArray[0] === '' && resolvedArray[resolvedArrayLength - 1] === '') {
    return resolvedArray[1];
  }

  return resolvedArray.reduce(function (memo, item) {
    memo += item;
    return memo;
  }, '');
}