import React from 'react';
import assign from 'lodash/assign';
import sula from '../core';
export function registerFieldPlugin(pluginName) {
  return function wrapComponent(Component, hasSource, hasCtx) {
    sula.fieldType(pluginName, function (ctx) {
      var config = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
      var mode = ctx.mode,
          source = ctx.source,
          disabled = ctx.disabled;
      var props = config.props || {};
      var extraProps = {
        disabled: disabled
      };

      if (mode === 'view') {
        extraProps.disabled = true;
      }

      if (hasSource) {
        extraProps.source = source;
      }

      if (hasCtx) {
        extraProps.ctx = ctx;
      }

      return React.createElement(Component, assign(extraProps, props));
    });
  };
}